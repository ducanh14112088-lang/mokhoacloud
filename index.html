<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>iBYPASS SHOP - Bypass iCloud Giá Rẻ 2025</title>
  <meta name="theme-color" content="#00ff9d">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>Unlock</text></svg>">
  <style>
    :root{--pri:#00ff9d;--bg:#0a0a0f;--card:#111118}
    body{margin:0;font-family:Segoe UI,sans-serif;background:var(--bg);color:#e0e7ff;min-height:100vh;background:radial-gradient(circle at top,rgba(0,255,157,0.08),#0a0a0f)}
    header{position:sticky;top:0;z-index:99;background:rgba(10,10,15,0.95);backdrop-filter:blur(12px);border-bottom:1px solid #333;padding:14px 20px;display:flex;justify-content:space-between;align-items:center}
    .logo{font-size:30px;font-weight:900;background:linear-gradient(90deg,#00ff9d,#00d4ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    nav a{color:#e0e7ff;text-decoration:none;padding:10px 18px;border-radius:10px;transition:.2s}
    nav a:hover{background:rgba(0,255,157,0.15)}
    .btn{background:linear-gradient(90deg,#00ff9d,#00d4ff);color:#000;padding:14px 32px;border-radius:12px;font-weight:700;cursor:pointer;box-shadow:0 4px 20px rgba(0,255,157,0.4);font-size:18px}
    .hero{text-align:center;padding:120px 20px;background:url('https://images.unsplash.com/photo-1639762681485-074b7f938ba0') center/cover;position:relative}
    .hero::after{content:'';position:absolute;inset:0;background:linear-gradient(45deg,rgba(10,10,15,0.9),rgba(0,0,0,0.6))}
    .hero h1{font-size:58px;margin:0;background:linear-gradient(90deg,#00ff9d,#00d4ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .section{max-width:1100px;margin:0 auto;padding:80px 20px}
    .card{background:var(--card);border:1px solid rgba(0,255,157,0.2);border-radius:18px;padding:35px;text-align:center;box-shadow:0 10px 40px #0006}
    .important{background:#300;border:2px solid #ff6b6b;padding:20px;border-radius:16px;margin:20px 0}
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.95);display:none;align-items:center;justify-content:center;z-index:999}
    .modal{max-width:420px;width:90%;background:#111;padding:30px;border-radius:18px;border:2px solid var(--pri);text-align:center}
    input{width:100%;padding:14px;margin:10px 0;border-radius:12px;border:1px solid #333;background:#000;color:#fff;font-size:16px}
    .online-badge{background:#00ff9d;color:#000;padding:4px 12px;border-radius:20px;font-size:12px;animation:blink 2s infinite;font-weight:900}
    @keyframes blink{0%,100%{opacity:1}50%{opacity:0.5}}
    .telegram-btn{position:fixed;bottom:20px;left:20px;background:#0088cc;color:white;width:60px;height:60px;border-radius:50%;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 20px #0088cc88;z-index:999}
  </style>
</head>
<body>

<header>
  <div><span class="logo">iBYPASS</span> SHOP <span class="online-badge">ONLINE</span></div>
  <nav>
    <a href="index.html">Trang chủ</a>
    <a href="dashboard.html">Cửa hàng</a>
    <span id="status" style="color:#00ff9d;font-weight:600">Chưa đăng nhập</span>
    <button class="btn" id="authBtn">Đăng nhập</button>
  </nav>
</header>

<div class="hero">
  <div style="position:relative;z-index:2">
    <h1>iCLOUD BYPASS GIÁ RẺ NHẤT 2025</h1>
    <p>iPhone 11 → 17 Pro Max • iPad A12–M4 • iOS 18.6–26.1<br>Chỉ từ <b>90.000₫</b> • Full thông báo, FaceTime</p>
    <a href="dashboard.html" class="btn" style="padding:18px 50px;font-size:22px">MUA NGAY TỪ 90K</a>
  </div>
</div>

<div class="section">
  <div class="card">
    <h2 style="color:#00ff9d">Thông tin chuyển khoản</h2>
    <div style="background:rgba(0,212,255,0.1);padding:20px;border-radius:12px;font-size:20px">
      STK: <span style="color:#00ff9d;font-size:26px">1404123456</span><br>
      MB Bank – NGUYEN DUC ANH
    </div>
    <div class="important">
      <h3 style="color:#ff6b6b;margin:0">BẮT BUỘC ghi nội dung:</h3>
      <code style="font-size:24px;color:#00ff9d;background:#000;padding:10px 20px;border-radius:12px" id="noidung">Đăng nhập để xem</code>
    </div>
  </div>
</div>

<!-- Nút Telegram chỉ có logo -->
<a href="https://t.me/dung_tool_wallet" target="_blank" class="telegram-btn" title="Liên hệ Telegram">
  <svg viewBox="0 0 240.83 240.83" width="36" height="36" fill="#fff" xmlns="http://www.w3.org/2000/svg">
    <path d="M57.65 184.28c-12.48 0-4.03-9.05-4.03-9.05l120.35-74.03c8.06-5.02 8.06-3.35 8.06-3.35l-124.38-74.03s-16.51-8.06-16.51 8.06c0 8.06 6.04 36.24 12.08 67.99l18.12 60.94s1.01 12.08 12.08 12.08c12.08 0 25.16-13.09 25.16-13.09l36.24-24.16 66.98 49.86c15.1 8.06 25.16 4.03 25.16 4.03l18.12-153.92s18.12-18.12 0-25.16c-12.08-5.02-36.24 20.14-36.24 20.14l-145.51 93.19c-12.08 6.04-25.16 9.05-25.16 9.05z"/>
  </svg>
</a>

<!-- Modal đăng nhập / đăng ký -->
<div id="authModal" class="modal-backdrop">
  <div class="modal">
    <h2 style="color:#00ff9d">Đăng nhập / Đăng ký</h2>
    <input type="email" id="email" placeholder="Email của bạn">
    <input type="password" id="pass1" placeholder="Mật khẩu">
    <input type="password" id="pass2" placeholder="Nhập lại mật khẩu" style="display:none">
    <div style="margin:20px 0;display:flex;gap:12px;flex-wrap:wrap;justify-content:center">
      <button class="btn" id="btnLogin">Đăng nhập</button>
      <button class="btn" id="btnSignup" style="background:#0066ff">Đăng ký</button>
      <button class="btn" id="btnCompleteSignup" style="display:none;background:#ff0066">HOÀN TẤT</button>
      <button class="btn" style="background:#666" onclick="closeAuth()">Hủy</button>
    </div>
    <p id="msg" style="color:#ff6b6b;height:30px"></p>
  </div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
  import { getDatabase, ref, set, get, onValue } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAidLdO5tVK8CkwRdMY91hG-ulXiNEohl4",
    authDomain: "mokhoacloud.firebaseapp.com",
    databaseURL: "https://mokhoacloud-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "mokhoacloud",
    storageBucket: "mokhoacloud.firebasestorage.app",
    messagingSenderId: "1013749304224",
    appId: "1:1013749304224:web:2a02b904c17c0aaf7c32c5"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  let currentUser = null;

  async function hash(p) {
    const data = new TextEncoder().encode(p);
    const hashBuffer = await crypto.subtle.digest('SHA-256', data);
    return Array.from(new Uint8Array(hashBuffer)).map(b => b.toString(16).padStart(2,'0')).join('');
  }

  function updateUI() {
    if (!currentUser) {
      document.getElementById('status').textContent = 'Chưa đăng nhập';
      document.getElementById('noidung').textContent = 'Đăng nhập để xem';
    } else {
      const isAdmin = currentUser.email === '998822jj';
      document.getElementById('status').textContent = currentUser.email + (isAdmin ? ' (Admin)' : '');
      document.getElementById('status').style.color = isAdmin ? '#ff0066' : '#00ff9d';
      document.getElementById('noidung').textContent = currentUser.email;
    }
    document.getElementById('authBtn').textContent = currentUser ? 'Đăng xuất' : 'Đăng nhập';
  }

  function closeAuth() {
    document.getElementById('authModal').style.display = 'none';
  }

  // Kiểm tra đã đăng nhập chưa
  const savedEmail = localStorage.getItem('userEmail');
  if (savedEmail) {
    const userRef = ref(db, 'users/' + btoa(savedEmail));
    onValue(userRef, (snap) => {
      if (snap.exists()) {
        currentUser = { ...snap.val(), email: savedEmail };
        updateUI();
      }
    }, { onlyOnce: true });
  }

  document.getElementById('authBtn').onclick = () => {
    if (currentUser) {
      if (confirm('Đăng xuất?')) {
        localStorage.removeItem('userEmail');
        currentUser = null;
        updateUI();
      }
      return;
    }
    document.getElementById('authModal').style.display = 'flex';
    document.getElementById('pass2').style.display = 'none';
    document.getElementById('btnSignup').style.display = 'inline-block';
    document.getElementById('btnCompleteSignup').style.display = 'none';
    document.getElementById('msg').textContent = '';
  };

  document.getElementById('btnLogin').onclick = async () => {
    const email = document.getElementById('email').value.trim();
    const pass = document.getElementById('pass1').value;
    const msg = document.getElementById('msg');
    if (!email || !pass) return msg.textContent = 'Nhập đầy đủ';

    const snap = await get(ref(db, 'users/' + btoa(email)));
    if (!snap.exists()) return msg.textContent = 'Email chưa đăng ký';
    if (await hash(pass) !== snap.val().pass) return msg.textContent = 'Sai mật khẩu';

    localStorage.setItem('userEmail', email);
    currentUser = { ...snap.val(), email };
    updateUI();
    closeAuth();
    alert('Đăng nhập thành công!');
  };

  document.getElementById('btnSignup').onclick = () => {
    document.getElementById('pass2').style.display = 'block';
    document.getElementById('btnSignup').style.display = 'none';
    document.getElementById('btnCompleteSignup').style.display = 'inline-block';
  };

  document.getElementById('btnCompleteSignup').onclick = async () => {
    const email = document.getElementById('email').value.trim();
    const p1 = document.getElementById('pass1').value;
    const p2 = document.getElementById('pass2').value;
    const msg = document.getElementById('msg');

    if (p1 !== p2) return msg.textContent = 'Mật khẩu không khớp';
    if (p1.length < 6) return msg.textContent = 'Mật khẩu ít nhất 6 ký tự';

    const exists = await get(ref(db, 'users/' + btoa(email)));
    if (exists.exists()) return msg.textContent = 'Email đã tồn tại';

    const h = await hash(p1);
    const newUser = {
      pass: h,
      balance: 0,
      orders: {},
      isAdmin: email === '998822jj'
    };

    await set(ref(db, 'users/' + btoa(email)), newUser);
    localStorage.setItem('userEmail', email);
    currentUser = { ...newUser, email };
    updateUI();
    closeAuth();
    alert('Đăng ký thành công! Chào mừng ' + (email === '998822jj' ? 'Admin' : 'thành viên mới') + '!');
  };

  updateUI();
</script>
</body>
</html>
